{% extends "pretixpresale/event/base.html" %}
{% load i18n %}
{% load bootstrap3 %}
{% load eventurl %}
{% load static %}

{% block title %}{% trans "New request" %}{% endblock %}
{% block content %}
    <h2>
        {% if form.fields.swap_type.choices|length > 1 %}
            {% blocktrans trimmed with code=order.code %}
                Request to swap or cancel your order: {{ code }}
            {% endblocktrans %}
        {% elif form.fields.swap_type.choices.0.0 == "s" %}
            {% blocktrans trimmed with code=order.code %}
                Request to swap your order: {{ code }}
            {% endblocktrans %}
        {% else %}
            {% blocktrans trimmed with code=order.code %}
                Request to cancel your order: {{ code }}
            {% endblocktrans %}
        {% endif %}
        {% if order.testmode %}
            <span class="label label-warning">{% trans "TEST MODE" %}</span>
        {% endif %}
        <a href="{% eventurl event "presale:event.order" secret=order.secret order=order.code %}"
                class="btn btn-default">
            {% trans "Back to order" %}
        </a>
        {% include "pretixpresale/event/fragment_order_status.html" with order=order event=request.event class="pull-right flip" %}
        <div class="clearfix"></div>
    </h2>
    <div class="alert alert-info">
        {% if form.fields.swap_type.choices|length > 1 %}
            {% blocktrans trimmed %}
            You can request to <b>swap</b> or <b>cancel</b> your order here.
            {% endblocktrans %}
            <br>
            {% blocktrans trimmed %}
            Swap requests will be approved automatically once a swap partner has been found.
            {% endblocktrans %}
            <br>
            {% blocktrans trimmed %}
            Cancelation requests will first be approved by the organizers, and will then be processed once then next person on the waiting list has paid for their new order.
            {% endblocktrans %}
        {% elif form.fields.swap_type.choices.0.0 == "s" %}
            {% blocktrans trimmed %}
            You can request to <b>swap</b> your order here.
            {% endblocktrans %}
            {% blocktrans trimmed %}
            Swap requests will be approved automatically once a swap partner has been found.
            {% endblocktrans %}
        {% else %}
            {% blocktrans trimmed %}
            You can request to <b>cancel</b> your order here.
            {% endblocktrans %}
            {% blocktrans trimmed %}
            Cancelation requests will first be approved by the organizers, and will then be processed once then next person on the waiting list has paid for their new order.
            {% endblocktrans %}
        {% endif %}

    </div>
    <form method="post">{% csrf_token %}
    {% bootstrap_form_errors form %}
    {% if form.position %}
        {% bootstrap_field form.position %}
    {% endif %}
    {% if form.swap_type %}
        {% bootstrap_field form.swap_type %}
    {% endif %}
    {% if form.swap_method %}
        {% bootstrap_field form.swap_method %}
    {% endif %}
    {% if form.cancel_method %}
        {% bootstrap_field form.cancel_method %}
    {% endif %}
    {% if form.swap_code %}
        {% bootstrap_field form.swap_code %}
    {% endif %}
    {% if form.cancel_code %}
        {% bootstrap_field form.cancel_code %}
    {% endif %}
    {% for field in form.position_fields %}
        {% bootstrap_field field %}
    {% endfor %}
    <div class="text-center">
        <p>
        </p>
        <p>
        {% if form.fields.swap_type.choices|length > 1 %}
            {% blocktrans trimmed %}
            A ticket offered for sale can not be withdrawed from the sale.
            {% endblocktrans %}
            {% blocktrans trimmed %}
            A swap request can be ended at any time.
            {% endblocktrans %}
        {% elif form.fields.swap_type.choices.0.0 == "s" %}
            {% blocktrans trimmed %}
            A swap request can be ended at any time.
            {% endblocktrans %}
        {% else %}
            {% blocktrans trimmed %}
            A ticket offered for sale can not be withdrawed from the sale.
            {% endblocktrans %}
        {% endif %}
        </p>
    </div>
    <button type="submit" class="btn btn-primary btn-block">{% trans "Send request" %}</button>
    </form>
    <script src="{% static "pretix_swap/swap.js" %}"></script>
{% endblock %}
